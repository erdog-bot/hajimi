services:
  hajimi-app: # æœåŠ¡åï¼Œå¯è‡ªå®šä¹‰
    image: beijixingxing/hajimi:latest
    container_name: hajimi-app  # å›ºå®šå®¹å™¨åæ–¹ä¾¿ç›‘æ§
    labels:
      - "com.centurylinklabs.watchtower.enable=true"  # å¯ç”¨è‡ªåŠ¨æ›´æ–°
    ports:
      - "7860:7860" # ç«¯å£æ˜ å°„ï¼šå†’å·å·¦è¾¹æ˜¯å®¿ä¸»æœºç«¯å£ï¼ˆå¯æ”¹ï¼‰ï¼Œå³è¾¹æ˜¯å®¹å™¨å†…ç«¯å£ï¼ˆå›ºå®š7860ï¼‰ã€‚
                    # å¦‚æœ 7860 ç«¯å£å†²çªï¼Œä¿®æ”¹å†’å·å·¦è¾¹çš„æ•°å­—ï¼Œä¾‹å¦‚ "17860:7860"
    env_file:
      - .env  # åŠ è½½ .env æ–‡ä»¶ä¸­çš„ç¯å¢ƒå˜é‡
    environment:
      - TZ=Asia/Shanghai # æ—¶åŒºé…ç½®ï¼Œé»˜è®¤ä¸­å›½æ—¶åŒºã€‚å¦‚éœ€ä¿®æ”¹ï¼Œä¾‹å¦‚ï¼šAmerica/New_York
      - ENABLE_STORAGE=true # åº”ç”¨å±‚é¢çš„æ•°æ®æŒä¹…åŒ–å¼€å…³ï¼Œé…åˆ volumes ä½¿ç”¨

      # --- ç½‘ç»œä»£ç† (æŒ‰éœ€å–æ¶ˆæ³¨é‡Šå¹¶ä¿®æ”¹) ---
      # å¦‚æœéœ€è¦ HTTP ä»£ç†:
      # HTTP_PROXY: "http://your_proxy_address:port"  # <= ä¾‹å¦‚ "http://127.0.0.1:7890"
      # å¦‚æœéœ€è¦ HTTPS ä»£ç† (é€šå¸¸ä¸ HTTP ä»£ç†ç›¸åŒ):
      # HTTPS_PROXY: "http://your_proxy_address:port" # <= ä¾‹å¦‚ "http://127.0.0.1:7890"
      # æ³¨æ„ï¼šåœ¨ Windows/Mac çš„ Docker Desktop ç¯å¢ƒä¸‹ï¼Œè‹¥ä»£ç†åœ¨å®¿ä¸»æœºä¸Šï¼Œå¯å°è¯•ä½¿ç”¨ "host.docker.internal"ä½œä¸ºåœ°å€ï¼Œ
      # ä¾‹å¦‚: HTTP_PROXY: "http://host.docker.internal:7890"
      # åœ¨ Linux æœåŠ¡å™¨ä¸Šï¼Œè¯·ç›´æ¥å¡«å†™ä»£ç†æœåŠ¡å™¨çš„ IP åœ°å€å’Œç«¯å£ã€‚

    volumes: # æ•°æ®æŒä¹…åŒ–é…ç½®
      - ./settings:/hajimi/settings # å°†å®¹å™¨å†…çš„ /hajimi/settings ç›®å½•æ˜ å°„åˆ°å½“å‰é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹çš„ settings å­ç›®å½•ã€‚
                                   # è¿™ä¼šä¿å­˜åº”ç”¨çš„æ‰€æœ‰é‡è¦é…ç½®å’Œæ•°æ®ï¼Œå³ä½¿å®¹å™¨æ›´æ–°æˆ–é‡å¯ä¹Ÿä¸ä¼šä¸¢å¤±ã€‚
                                   # é¦–æ¬¡å¯åŠ¨åï¼Œæ‚¨ä¼šåœ¨ hajimi-app æ–‡ä»¶å¤¹ä¸‹çœ‹åˆ°ä¸€ä¸ªæ–°åˆ›å»ºçš„ settings æ–‡ä»¶å¤¹ã€‚
    restart: unless-stopped # å®¹å™¨é€€å‡ºæ—¶è‡ªåŠ¨é‡å¯ï¼Œé™¤éæ˜¯æ‰‹åŠ¨åœæ­¢çš„ã€‚

  # ğŸ†™ è‡ªåŠ¨æ›´æ–°ç›‘æ§æœåŠ¡ï¼ˆé»˜è®¤æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡ï¼‰
  watchtower:
    image: containrrr/watchtower
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock  # å¿…é¡»çš„Dockerè¿æ¥é…ç½®
    environment:
      - TZ=Asia/Shanghai # æ—¶åŒºé…ç½®
      - WATCHTOWER_LABEL_ENABLE=true  # åªç›‘æ§å¸¦æœ‰ "com.centurylinklabs.watchtower.enable=true" æ ‡ç­¾çš„å®¹å™¨
      - WATCHTOWER_POLL_INTERVAL=3600  # æ£€æŸ¥é—´éš”ç§’æ•°ï¼ˆ3600ç§’ = 1å°æ—¶ï¼‰
      - WATCHTOWER_CLEANUP=true  # æ›´æ–°åè‡ªåŠ¨åˆ é™¤æ—§é•œåƒ
    restart: unless-stopped